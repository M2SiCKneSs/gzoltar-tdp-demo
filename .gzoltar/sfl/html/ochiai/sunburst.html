<!DOCTYPE html>
<!--
  Copyright (C) 2020 GZoltar contributors.

  This file is part of GZoltar.

  GZoltar is free software: you can redistribute it and/or modify it under the terms of the GNU
  Lesser General Public License as published by the Free Software Foundation, either version 3 of
  the License, or (at your option) any later version.

  GZoltar is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even
  the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser
  General Public License for more details.

  You should have received a copy of the GNU Lesser General Public License along with GZoltar. If
  not, see <https://www.gnu.org/licenses/>.
-->
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Sunburst View</title>
  </head>

  <body>
    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js"></script>

    <script type="text/javascript" src="gzoltar.js"></script>

    <script type="text/javascript">
      var w, h, r, y;

      function initVars() {
        w = window.innerWidth - 15;
        h = window.innerHeight - 10;
        r = Math.min(w, h) / 2.1;
        y = d3.scale.sqrt().range([0, r]);
      };
      var x = d3.scale.linear().range([0, 2 * Math.PI]);
      initVars();
      var svg = d3.select("body").append("svg:svg").attr("width", w).attr("height", h).append("svg:g").call(d3.behavior.zoom().on("zoom", zoomRedraw)).on("dblclick.zoom", null).append("svg:g");
      var partition = d3.layout.partition().value(function(d) {
        return d.size;
      });
      var arc = d3.svg.arc();

      function defineArc() {
        arc.startAngle(function(d) {
          return Math.max(0, Math.min(2 * Math.PI, x(d.x)));
        }).endAngle(function(d) {
          return Math.max(0, Math.min(2 * Math.PI, x(d.x + d.dx)));
        }).innerRadius(function(d) {
          return Math.max(0, y(d.y));
        }).outerRadius(function(d) {
          return Math.max(0, y(d.y + d.dy) - 3);
        });
      };
      defineArc();

      // inject JSON in here, e.g.,
      // var root = JSON.parse('...');
var root = JSON.parse('{"children":[{"children":[{"children":[{"children":[{"children":[],"label":"demo.gzoltar$Calculator#Calculator():7","probability":0.3872983346207417,"size":48}],"label":"demo.gzoltar$Calculator#Calculator()","probability":0.3872983346207417,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#add(int,int):13","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#add(int,int)","probability":0.0,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#subtract(int,int):20","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#subtract(int,int)","probability":0.0,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#multiply(int,int):28","probability":0.3333333333333333,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#multiply(int,int):29","probability":0.4082482904638631,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#multiply(int,int):31","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#multiply(int,int)","probability":0.4082482904638631,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#divide(int,int):38","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#divide(int,int):39","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#divide(int,int):43","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#divide(int,int):44","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#divide(int,int):47","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#divide(int,int)","probability":0.0,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):54","probability":0.3333333333333333,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):55","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):59","probability":0.4082482904638631,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):60","probability":0.5773502691896258,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):63","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):64","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):65","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#power(int,int):67","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#power(int,int)","probability":0.5773502691896258,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):74","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):75","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):77","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):78","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):81","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):82","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):83","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#factorial(int):85","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#factorial(int)","probability":0.0,"size":48},{"children":[{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):92","probability":0.2886751345948129,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):93","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):97","probability":0.2886751345948129,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):98","probability":0.5773502691896258,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):101","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):102","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):105","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):106","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):107","probability":0.0,"size":48},{"children":[],"label":"demo.gzoltar$Calculator#isPrime(int):110","probability":0.0,"size":48}],"label":"demo.gzoltar$Calculator#isPrime(int)","probability":0.5773502691896258,"size":48}],"label":"demo.gzoltar$Calculator","probability":0.5773502691896258,"size":48}],"label":"demo.gzoltar","probability":0.5773502691896258,"size":48}],"label":"root","probability":0.5773502691896258,"size":48}');

      var clicked = root;
      var maxProb = probabilities(root);
      g = getG();
      gt = getGt();
      var colors = new Array();
      var centered;
      var path = svg.datum(root).selectAll("path").append("name").data(partition.nodes).enter().append("svg:a").attr("xlink:href", function(d) {
        return "#" + d.label
      }).append("path").style("stroke", "#fff").style("fill", fill).style("fill-rule", "evenodd").on("mouseover", mouseover).on("mouseout", mouseout).on("dblclick", function(d) {
        clicked = d;
        return click(root == d ? root : d);
      });

      function defineG_and_Path() {
        d3.select("g").attr("transform", "translate(" + w / 2 + "," + h * .52 + ")");
        svg.selectAll("path").attr("d", arc);
      };
      defineG_and_Path();
      path.append("svg:title").text(function(d) {
        return d.label + " | " + "Suspiciousness: " + d.probability.toFixed(3)
      });

      function click(d) {
        path.transition().duration(750).attrTween("d", arcTween(d));
      };

      function arcTween(d) {
        var xd = d3.interpolate(x.domain(), [d.x, d.x + d.dx]),
            yd = d3.interpolate(y.domain(), [d.y, 1]),
            yr = d3.interpolate(y.range(), [d.y ? 20 : 0, r]);
        return function(d, i) {
          return i ? function(t) {
            return arc(d);
          } : function(t) {
            x.domain(xd(t));
            y.domain(yd(t)).range(yr(t));
             return arc(d);
          };
        };
      };

      function resize(event) {
        initVars();
        defineArc();
        defineG_and_Path();
        resizeBody();
        resizeSvg();
        click(clicked);
      };
      d3.select(self.frameElement).style("height", h + "px");
      onResize();
      onRightClick();
    </script>
  </body>

</html>
